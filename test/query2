CREATE TABLE PART (P_PARTKEY INTEGER, P_NAME STRING, P_MFGR STRING, P_BRAND STRING, P_TYPE STRING, P_SIZE INTEGER, P_CONTAINER STRING, P_RETAILPRICE DOUBLE, P_COMMENT STRING);
CREATE TABLE SUPPLIER (S_SUPPKEY INTEGER, S_NAME STRING, S_ADDRESS STRING, S_NATIONKEY INTEGER, S_PHONE STRING, S_ACCTBAL DOUBLE, S_COMMENT STRING);
CREATE TABLE PARTSUPP (PS_PARTKEY INTEGER, PS_SUPPKEY INTEGER, PS_AVAILQTY INTEGER, PS_SUPPLYCOST DOUBLE, PS_COMMENT STRING);
CREATE TABLE CUSTOMER (C_CUSTKEY INTEGER, C_NAME STRING, C_ADDRESS STRING, C_NATIONKEY INTEGER, C_PHONE STRING, C_ACCTBAL DOUBLE, C_MKTSEGMENT STRING, C_COMMENT STRING);
CREATE TABLE ORDERS (O_ORDERKEY INTEGER, O_CUSTKEY INTEGER, O_ORDERSTATUS STRING, O_TOTALPRICE DOUBLE, O_ORDERDATE DATE, O_ORDERPRIORITY STRING, O_CLERK STRING, O_SHIPPRIORITY INTEGER, O_COMMENT STRING);
CREATE TABLE LINEITEM (L_ORDERKEY INTEGER, L_PARTKEY INTEGER, L_SUPPKEY INTEGER, L_LINENUMBER INTEGER, L_QUANTITY DOUBLE, L_EXTENDEDPRICE DOUBLE, L_DISCOUNT DOUBLE, L_TAX DOUBLE, L_RETURNFLAG STRING, L_LINESTATUS STRING, L_SHIPDATE DATE, L_COMMITDATE DATE, L_RECEIPTDATE DATE, L_SHIPINSTRUCT STRING, L_SHIPMODE STRING, L_COMMENT STRING);
CREATE TABLE NATION(N_NATIONKEY INTEGER, N_NAME STRING, N_REGIONKEY INTEGER, N_COMMENT STRING);
CREATE TABLE REGION(R_REGIONKEY INTEGER, R_NAME STRING, R_COMMENT STRING);
CREATE TABLE PLAYERS(ID STRING, FIRSTNAME STRING, LASTNAME STRING, FIRSTSEASON INTEGER, LASTSEASON INTEGER, WEIGHT INTEGER, BIRTHDATE DATE);

SELECT L_EXTENDEDPRICE, L_DISCOUNT, L_QUANTITY 
FROM LINEITEM 
WHERE L_DISCOUNT > 0.05 AND L_QUANTITY > 39 
ORDER BY L_EXTENDEDPRICE 
LIMIT 20;

SELECT C.*, N.N_NAME, R.R_NAME 
FROM CUSTOMER C, NATION N, REGION R 
WHERE N.N_NATIONKEY = C.C_NATIONKEY AND N.N_NATIONKEY < 3;

SELECT D.C_NAME, D.N_NAME 
FROM (SELECT C.*, N.N_NAME, R.R_NAME 
      FROM CUSTOMER C, NATION N, REGION R 
          WHERE R.R_REGIONKEY = N.N_REGIONKEY AND N.N_NATIONKEY = C.C_NATIONKEY AND R.R_NAME = 'AMERICA') D, 
      ORDERS O, LINEITEM L WHERE O.O_ORDERKEY = L.L_ORDERKEY AND O.O_CUSTKEY = D.C_CUSTKEY AND L.L_PARTKEY < 5 ORDER BY D.C_NAME 
LIMIT 5;

SELECT L.L_EXTENDEDPRICE, L.L_DISCOUNT FROM LINEITEM L, PART P 
WHERE 
    P.P_PARTKEY = L.L_PARTKEY AND L.L_DISCOUNT < 0.05 
    AND ((L.L_QUANTITY >= 1 AND L.L_QUANTITY <= 11 AND P.P_SIZE >= 1 AND P.P_SIZE <= 5 AND L.L_SHIPINSTRUCT = 'DELIVER IN PERSON') 
OR  (L.L_QUANTITY >= 10 AND L.L_QUANTITY <= 20 AND P.P_SIZE >= 1 AND P.P_SIZE <= 10 AND L.L_SHIPINSTRUCT = 'DELIVER IN PERSON') 
OR  (L.L_QUANTITY >= 20 AND L.L_QUANTITY <= 30 AND P.P_SIZE >= 1 AND P.P_SIZE <= 15 AND L.L_SHIPINSTRUCT = 'DELIVER IN PERSON')) 
ORDER BY L.L_EXTENDEDPRICE DESC;

SELECT SUB_Q.P1_FIRSTNAME, SUB_Q.P1_LASTNAME, 
       SUB_Q.P2_FIRSTNAME, SUB_Q.P2_LASTNAME 
FROM (SELECT P1.FIRSTNAME AS P1_FIRSTNAME, P1.LASTNAME AS P1_LASTNAME, 
              P2.FIRSTNAME AS P2_FIRSTNAME, P2.LASTNAME AS P2_LASTNAME, 
              P1.FIRSTSEASON AS P1_FIRSTSEASON, P1.LASTSEASON AS P1_LASTSEASON, 
              P2.FIRSTSEASON AS P2_FIRSTSEASON, P2.LASTSEASON AS P2_LASTSEASON 
       FROM PLAYERS P1, PLAYERS P2 
       WHERE P1.ID<>P2.ID AND P1.FIRSTSEASON > 2007 AND P2.FIRSTSEASON > 2007) SUB_Q;
